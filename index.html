<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>T2DM Health Plan Decision Aid</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Load Chart.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <h1>T2DM Health Plan Decision Aid</h1>
    <p>Using Preference-Space Latent Class Coefficients</p>
  </header>
  
  <main>
    <!-- Input and Results Section -->
    <section id="input-results">
      <div id="input-section">
        <h2>Patient Characteristics & Plan Attributes</h2>
        <form id="decisionForm">
          <!-- Demographics -->
          <div class="form-group">
            <label for="age" title="Patient's age in years (18-120).">Age:</label>
            <input 
              type="number" 
              id="age" 
              name="age" 
              min="18" max="120" 
              placeholder="e.g., 50" 
              required
            />
          </div>

          <div class="form-group">
            <label for="gender" title="Biological sex at birth.">Gender:</label>
            <select id="gender" name="gender">
              <option value="male">Male</option>
              <option value="female">Female</option>
            </select>
          </div>

          <div class="form-group">
            <label for="race" title="Race/Ethnicity (used in membership).">Race:</label>
            <select id="race" name="race">
              <option value="other">Other/Not listed</option>
              <option value="white">White</option>
              <option value="black">Black</option>
            </select>
          </div>

          <div class="form-group">
            <label for="income" title="High or Low Income group.">Income Group:</label>
            <select id="income" name="income">
              <option value="low">Low Income</option>
              <option value="high">High Income</option>
            </select>
          </div>

          <div class="form-group">
            <label for="degree" title="Has a Degree or Higher qualification?">Degree or Higher:</label>
            <select id="degree" name="degree">
              <option value="no">No</option>
              <option value="yes">Yes</option>
            </select>
          </div>

          <div class="form-group">
            <label for="goodHealth" title="Self-reported good health?">Self-Reported Good Health:</label>
            <select id="goodHealth" name="goodHealth">
              <option value="no">No</option>
              <option value="yes">Yes</option>
            </select>
          </div>

          <!-- Experiment Selection -->
          <div class="form-group">
            <label for="experiment" title="Choose Experiment 1, 2, or 3.">Experiment:</label>
            <select id="experiment" name="experiment">
              <option value="1">Exp 1 (Self-Focused)</option>
              <option value="2">Exp 2 (Self &amp; Others, Equal Outcomes)</option>
              <option value="3">Exp 3 (Self vs. Others, Unequal Outcomes)</option>
            </select>
          </div>

          <!-- Plan Attributes -->
          <h3>Plan Attributes</h3>

          <!-- Efficacy (Self) -->
          <div class="slider-container">
            <label for="efficacySelf" title="Efficacy for self, 0-100 scale">Efficacy (Self):</label>
            <input 
              type="range" 
              id="efficacySelf" 
              min="0" max="100" step="1" 
              value="30"
            />
            <span id="efficacySelfValue" class="slider-value">30</span>
          </div>

          <!-- Risk (Self) -->
          <div class="slider-container">
            <label for="riskSelf" title="Risk of side effects for self (0-100%).">Risk (Self, %):</label>
            <input 
              type="range" 
              id="riskSelf" 
              min="0" max="100" step="1" 
              value="10"
            />
            <span id="riskSelfValue" class="slider-value">10</span>
          </div>

          <!-- Cost (Self) -->
          <div class="slider-container">
            <label for="costSelf" title="Cost for self, 0-2000 in $">Cost (Self, $):</label>
            <input 
              type="range" 
              id="costSelf" 
              min="0" max="2000" step="50" 
              value="200"
            />
            <span id="costSelfValue" class="slider-value">200</span>
          </div>

          <!-- Efficacy (Others) -->
          <div class="slider-container">
            <label for="efficacyOthers" title="Efficacy for others in Exp 3. 0-100 scale">Efficacy (Others):</label>
            <input 
              type="range" 
              id="efficacyOthers" 
              min="0" max="100" step="1" 
              value="10"
            />
            <span id="efficacyOthersValue" class="slider-value">10</span>
          </div>

          <!-- Risk (Others) -->
          <div class="slider-container">
            <label for="riskOthers" title="Risk of side effects for others (0-100%).">Risk (Others, %):</label>
            <input 
              type="range" 
              id="riskOthers" 
              min="0" max="100" step="1" 
              value="5"
            />
            <span id="riskOthersValue" class="slider-value">5</span>
          </div>

          <!-- Cost (Others) -->
          <div class="slider-container">
            <label for="costOthers" title="Cost for others in Exp 3, 0-2000 in $">Cost (Others, $):</label>
            <input 
              type="range" 
              id="costOthers" 
              min="0" max="2000" step="50" 
              value="100"
            />
            <span id="costOthersValue" class="slider-value">100</span>
          </div>

          <button type="button" id="predictBtn">Predict Plan Uptake</button>
          <button type="button" id="saveBtn">Save Result</button>
        </form>
      </div>

      <div id="results-section">
        <h2>Results</h2>
        <div id="classInfo">
          <h3>Class Membership Probabilities</h3>
          <canvas id="membershipChart" width="400" height="200"></canvas>
          <pre id="classProbabilities"></pre>
        </div>
        
        <div id="uptakeInfo">
          <h3>Plan Uptake vs. Opt-Out</h3>
          <canvas id="uptakeChart" width="400" height="200"></canvas>
          <pre id="uptakeProbability"></pre>
        </div>
      </div>
    </section>

    <!-- Additional Tabs -->
    <section id="additional-tabs">
      <div class="tab">
        <button class="tablinks" onclick="openAdditionalTab(event, 'WTP')" id="wtpTab">WTP</button>
        <button class="tablinks" onclick="openAdditionalTab(event, 'Comparison')">Comparison</button>
        <button class="tablinks" onclick="openAdditionalTab(event, 'SavedResults')">Saved Results</button>
      </div>

      <!-- WTP Tab -->
      <div id="WTP" class="tabcontent">
        <h2>Willingness To Pay (WTP)</h2>
        <canvas id="wtpChart" width="400" height="200"></canvas>
      </div>

      <!-- Comparison Tab -->
      <div id="Comparison" class="tabcontent">
        <h2>Comparison of Scenarios</h2>
        <canvas id="comparisonChart" width="600" height="400"></canvas>
      </div>

      <!-- Saved Results Tab -->
      <div id="SavedResults" class="tabcontent">
        <h2>Saved Results</h2>
        <div id="savedResultsContainer">
          <ul id="savedResultsList"></ul>
        </div>
        <button type="button" id="clearSavedBtn">Clear Saved Results</button>
      </div>
    </section>
  </main>

  <footer>
    <p>T2DM Decision Aid (Preference-Space LC). Built for demonstration.</p>
  </footer>

  <!-- Custom Script -->
  <script src="script.js"></script>
</body>
</html>
